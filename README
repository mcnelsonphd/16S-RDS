This is the official project home for the scripts necessary to carry out the various pre-processing and analysis steps that are recommended and implemented in the RDS processing scheme published by Nelson et al. PLoS ONE 9: e94249. doi:10.1371/journal.pone.0094249.

The primary scripts are V4-Preprocess, Qiime_Analysis, and Reanalyze_16S.

V4_Preprocess is the first step of the analysis pipeline. It takes the three raw Undetermined files from the MiSeq and proceeds with read-merging using SeqPrep, phiX identification via bowtie2 and removal, and length filtering of reads that fall outside the expected size range for V4 amplicons (< 240, > 265 bp) using a custom biopython script. The final results of this step are a Good_Reads_filtered.fastq.gz and Good_Index_filtered.fastq.gz file. Intermediate files are placed in a V4_Intermediates directory. The script operates on a checkpointing scheme and will attempt to restart after the last successfully completed step in case of failure.

Qiime_Analysis is the second step of the analysis pipeline and will take demultiplexed sequences and proceed through a pre-defined set of QIIME analyses, principally involving reference OTU assignment followed by de novo OTU assignment of reads that failed to be assigned to a reference OTU as recommended and implemented in the RDS processing method. The user supplies the script with their QIIME demultiplexed sequences in FASTA format and the sample mapping file and the script will proceed through OTU assignment, chimera checking with ChimeraSlayer, OTU table filtering, taxonomy assignment, and simple alpha and beta diversity analyses of both un-normalized and normalized data. 

An important note is that the script will automatically normalize samples to the smallest sample size via rarefaction according to the sequence counts of the filtered OTU table. In cases where samples are under-sampled, this can bias the results of alpha and beta diversity analyses due to normalization to an unsatisfactory number of sequences. To compensate for this, an additional script, Reanlayze_16S is provided.